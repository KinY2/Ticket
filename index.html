<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Virtual Ticket Slide</title>

<!-- Google Font: Roboto -->
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap">

<style>
  body {
    margin: 0;
    padding: 0;
    font-family: 'Roboto', sans-serif;
    background-color: #f0f0f0;
    overflow-x: hidden;
  }

  .ticket {
    position: absolute;
    right: -100%;
    top: 10%;
    transform: translateY(-50%);
    height: 80vh;
    aspect-ratio: 3 / 1;
    transform-origin: right center;
    background: url('ticket.png') no-repeat center center;
    background-size: cover;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 4vw;
    font-weight: bold;
    color: #000;
  }

  #seatDisplay {
    position: absolute;
    top: 75%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 4vh;
    color: white;
    display: none;
  }

  #generateBtn {
    display: none;
    position: absolute;
    top: 75%;
    left: 40%;
    transform: translateY(-50%);
    padding: 12px 24px;
    font-size: 4vh;
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
  }

  @keyframes slideAndRotate {
    0% { right: -100%; transform: rotate(0deg) scale(1); }
    60% { top: 10%; right: 50%; transform: rotate(0deg) scale(1); }
    100% { right: 50%; top: 50%; transform: rotate(90deg); }
  }

  .animateTicket {
    animation: slideAndRotate 3s ease forwards;
  }
</style>
</head>
<body>

<div class="ticket" id="ticketDisplay"></div>
<div id="seatDisplay"></div>
<button id="generateBtn">Click me!</button>

<script>
  const ticketDiv = document.getElementById('ticketDisplay');
  const seatDiv = document.getElementById('seatDisplay');
  const button = document.getElementById('generateBtn');

  window.addEventListener('load', () => {
    // start ticket animation
    ticketDiv.classList.add('animateTicket');

    // show button after animation
    setTimeout(() => {
      button.style.display = 'block';
    }, 3000);

    // button click: fetch seat from server
    button.addEventListener('click', async () => {
      button.style.display = 'none';

      try {
        const response = await fetch("https://script.google.com/macros/s/AKfycbxolmsKQto0Z75AY-OZs_5Ai1aCyYFUCTCR3w7MykJejKOcWunUSCpQOpVUZj1YEJeA/exec");
        const data = await response.json();
        if (data.seat) {
          seatDiv.innerText = data.seat;
        } else {
          seatDiv.innerText = 'No seats available';
        }
        seatDiv.style.display = 'block';
      } catch (err) {
        seatDiv.innerText = 'Error fetching seat';
        seatDiv.style.display = 'block';
        console.error(err);
      }
    });
  });
</script>

</body>
</html>
